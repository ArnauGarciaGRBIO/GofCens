<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical Tools • GofCens</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Graphical Tools">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GofCens</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Goodness_of_fit_Tests.html">Goodness of fit Tests</a>
    </li>
    <li>
      <a href="../articles/Graphical_Tools.html">Graphical Tools</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ArnauGarciaGRBIO/GofCens/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Graphical Tools</h1>
                        <h4 data-toc-skip class="author">Arnau
Garcia</h4>
            
            <h4 data-toc-skip class="date">2024-11-07</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ArnauGarciaGRBIO/GofCens/blob/HEAD/vignettes/Graphical_Tools.Rmd" class="external-link"><code>vignettes/Graphical_Tools.Rmd</code></a></small>
      <div class="hidden name"><code>Graphical_Tools.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="graphical-tools-for-goodness-of-fit">Graphical tools for goodness of fit<a class="anchor" aria-label="anchor" href="#graphical-tools-for-goodness-of-fit"></a>
</h2>
<p>The <strong>GofCens</strong> package provides six different plots for
evaluating goodness of fit, applicable to both complete and
right-censored data. In most cases, a roughly straight line formed by
the points suggests good agreement with the hypothesized theoretical
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_0(t)</annotation></semantics></math>.</p>
<p>Following,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>n</mi></msub><annotation encoding="application/x-tex">\hat{F}_n</annotation></semantics></math>
represents the empirical distribution function in case the data are
complete data and 1 minus the Kaplan-Meier estimator of the survival
function if the data are subject to random right-censorship.</p>
<p>We will illustrate how the functions of the package works using the
following simulated survival times. We generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>300</mn><annotation encoding="application/x-tex">300</annotation></semantics></math>
survival times from a log-normal distribution with location parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mu = 2</annotation></semantics></math>
and scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta=1</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>∼</mo><mi>L</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T\sim LN(2,1)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>300</mn><annotation encoding="application/x-tex">300</annotation></semantics></math>
censoring times from an exponential distribution with scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">\beta=20</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>∼</mo><mi>E</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>20</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C\sim Exp(20)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">survt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">censt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The observed right-censored survival times,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = min(T, C)</annotation></semantics></math>,
and the corresponding event indicators,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>𝟏</mn><mo stretchy="false" form="prefix">{</mo><mi>T</mi><mo>≤</mo><mi>C</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\delta = \boldsymbol{1}\{T \leq C\}</annotation></semantics></math>,
are created as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">survt</span>, <span class="va">censt</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">survt</span> <span class="op">&lt;=</span> <span class="va">censt</span><span class="op">)</span></span></code></pre></div>
<p>In total,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>106</mn><annotation encoding="application/x-tex">106</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>35.3</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">35.3\%</annotation></semantics></math>)
of the survival times of the generated sample are right-censored:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span><span class="co">#&gt; delta</span></span>
<span><span class="co">#&gt;   0   1 </span></span>
<span><span class="co">#&gt; 106 194</span></span></code></pre></div>
<div class="section level3">
<h3 id="probability-and-quantile-quantile-plots">Probability and quantile-quantile plots<a class="anchor" aria-label="anchor" href="#probability-and-quantile-quantile-plots"></a>
</h3>
<p>The probability-probability plot (P-P plot) maps
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_0(t)</annotation></semantics></math>
against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_n(t)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_0(t)</annotation></semantics></math>
corresponds to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_0(t)</annotation></semantics></math>
with the unknown parameters replaced by their maximum likelihood
estimates. In order to enhance the interpretability of the P-P plot and
because some of the plotted points have a larger variability than
others, Stabilised Probability plot (SP plot) are used. In the same way
as the arcsin transformation can be used to stabilise the variance of a
uniform order statistic, this function can be applied to stabilise the
variance of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_0(t)</annotation></semantics></math>.
The variances of the resulting SP plotted points are all approximately
equal.</p>
<p>The quantile-quantile plot (Q-Q plot) maps the theoretical quantiles
against the estimated quantiles, that is,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_0^{-1}(\hat{F}_n(t))</annotation></semantics></math>
against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
An empirical rescaling of the axes can help to overcome the problem that
the plotted points might not be evenly spread, in particular in the
presence of right-censored data. The Empirically Rescaled plot (ER plot)
plots
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn><mrow><mo>−</mo><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_u(\hat{F}_0^{-1}(\hat{F}_n(t)))</annotation></semantics></math>
against
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>u</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\hat{F}_u(t)</annotation></semantics></math>,
where the latter is the empirical cumulative distribution function of
the points corresponding to the uncensored observations.</p>
<p>The four plots exposed above (P-P, Q-Q, SP and ER plot) can be done
by means of the <code><a href="../reference/probPlot.html">probPlot()</a></code> function. By default, the
function draws all four plots, but provides the user with the option to
choose only a subset of these, and by default
(<code>prnt == TRUE</code>), it returns the maximum likelihood estimates
of the parameters of the distribution under study, with the
corresponding standard errors, AIC and BIC. Notice that these estimates
are used to draw the plots if no specific distribution parameters are
provided. One graphical feature of the function is the option for the
user to choose between the base package <strong>graphics</strong>, which
is the default, and the <strong>ggplot2</strong>package for drawing the
plots. In the former case, <code><a href="../reference/probPlot.html">probPlot()</a></code> internally calls the
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> function, enabling the user to set graphical
parameters within the function call.</p>
<p>For the illustration of the <code><a href="../reference/probPlot.html">probPlot()</a></code> function, we
assess how well the log-normal distribution and the Weibull distribution
fit to the sample data. The first four plots show fairly straight lines,
thus confirming that the underlying distribution is the log-normal
distribution, whereas the other plots clearly show that the Weibull
distribution would not be an adequate distribution to model the
data.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/probPlot.html">probPlot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span>, prnt <span class="op">=</span> <span class="cn">FALSE</span>, cex.lab <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/probPlot.html">probPlot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"weibull"</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span>, prnt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-4-2.png" width="700"></p>
<p>Note that since <code>prnt</code> is set to <code>FALSE</code>, the
maximum likelihood estimates under of both distributions parameters are
not returned.</p>
<p>To illustrate additional functionalities of this function, we apply
it again on the data set to assess the suitability of fitting a
log-normal distribution with parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mu=2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta=1</annotation></semantics></math>.
For this purpose, we employ the <code>params0</code> argument, whose
default value is <code>NULL</code>, to specify the parameter values.
Additionally, the main argument is a <code>Surv</code> object and we
utilize the m argument to display the four probability plots in a single
row.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/probPlot.html">probPlot</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span>, m <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>         params0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: log-normal </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Parameters used in probability plots:</span></span>
<span><span class="co">#&gt; Location: 2 </span></span>
<span><span class="co">#&gt;    Scale: 1.5 </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; Location (se): 1.988 (0.058)</span></span>
<span><span class="co">#&gt;    Scale (se): 0.883 (0.045)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    AIC: 1266.899 </span></span>
<span><span class="co">#&gt;    BIC: 1274.307</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<p>From these plots, it becomes evident that this log-normal
distribution does not fit well to the data. Moreover, in this
illustration, the function provides both the parameter values used in
the probability plots and the maximum likelihood estimates of the
parameters with the corresponding standard errors, AIC and BIC.</p>
</div>
<div class="section level3">
<h3 id="cumulative-hazard-plot">Cumulative hazard plot<a class="anchor" aria-label="anchor" href="#cumulative-hazard-plot"></a>
</h3>
<p>Another set of plots consists of cumulative hazard plots, derived
from transforming the cumulative hazard function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>
in such a way that it becomes linear in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
or in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\log(t)</annotation></semantics></math>.
The Nelson-Aalen estimator
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>Λ</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\Lambda}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Λ</mi><annotation encoding="application/x-tex">\Lambda</annotation></semantics></math>
is computed from the data, and the distribution-specific transformation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mrow><mo stretchy="true" form="prefix">(</mo><mover><mi>Λ</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">A(\hat{\Lambda}(t))</annotation></semantics></math>
is then plotted against either
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
or its natural logarithm.</p>
<p>The <code><a href="../reference/cumhazPlot.html">cumhazPlot()</a></code> function can be used to draw cumulative
hazard plots for any of the distributions available in the
<strong>GofCens</strong> package. Given a set of survival times, this
function is a helpful tool to assess which parametric model fits best to
the given data.</p>
<p>By default, the function draws the cumulative hazard plots for the
Weibull, Gumbel, log-logistic, logistic, log-normal, and normal
distributions, but provides the user with the options to also choose the
exponential and beta distribution or a subset of all these. Like the
<code><a href="../reference/probPlot.html">probPlot()</a></code> function, the user can choose between the base
package graphics, which is the default value, and the ggplot2 package to
draw the plots, and by default, the maximum likelihood estimates of the
distribution under study are returned with the corresponding standard
errors, the AIC and the BIC.</p>
<p>An illustration with the previously generated right-censored sample
from the log-normal distribution is shown. As expected, the points of
the cumulative hazard plot for the log-normal distribution show a fairly
straight line, whereas most of the other distributions under study can
clearly be discarded. The corresponding code is the following. Different
from the previous example, the function returns the parameter estimated
for each of the six default distributions.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span> <span class="fu"><a href="../reference/cumhazPlot.html">cumhazPlot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, font.lab <span class="op">=</span> <span class="fl">4</span>, cex.lab <span class="op">=</span> <span class="fl">1.3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Parameter estimates</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; weibull</span></span>
<span><span class="co">#&gt;    Shape (se): 1.273 (0.067)</span></span>
<span><span class="co">#&gt;    Scale (se): 10.98 (0.621)</span></span>
<span><span class="co">#&gt;    AIC: 1304.046 </span></span>
<span><span class="co">#&gt;    BIC: 1311.453 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loglogistic</span></span>
<span><span class="co">#&gt;    Shape (se): 1.944 (0.113)</span></span>
<span><span class="co">#&gt;    Scale (se): 7.185 (0.415)</span></span>
<span><span class="co">#&gt;    AIC: 1272.479 </span></span>
<span><span class="co">#&gt;    BIC: 1279.887 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lognormal</span></span>
<span><span class="co">#&gt; Location (se): 1.988 (0.058)</span></span>
<span><span class="co">#&gt;    Scale (se): 0.883 (0.045)</span></span>
<span><span class="co">#&gt;    AIC: 1266.899 </span></span>
<span><span class="co">#&gt;    BIC: 1274.307 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; gumbel</span></span>
<span><span class="co">#&gt; Location (se): 6.376 (0.328)</span></span>
<span><span class="co">#&gt;    Scale (se): 4.954 (0.296)</span></span>
<span><span class="co">#&gt;    AIC: 1342.493 </span></span>
<span><span class="co">#&gt;    BIC: 1349.901 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; logistic</span></span>
<span><span class="co">#&gt; Location (se): 8.507 (0.433)</span></span>
<span><span class="co">#&gt;    Scale (se): 3.842 (0.231)</span></span>
<span><span class="co">#&gt;    AIC: 1430.253 </span></span>
<span><span class="co">#&gt;    BIC: 1437.661 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; normal</span></span>
<span><span class="co">#&gt; Location (se): 9.894 (0.492)</span></span>
<span><span class="co">#&gt;    Scale (se): 7.537 (0.381)</span></span>
<span><span class="co">#&gt;    AIC: 1456.224 </span></span>
<span><span class="co">#&gt;    BIC: 1463.631</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>If the user wants to assess the goodness of fit of the exponential
and the beta distribution and compare these with the fit of the
log-normal distribution, she/he has to specifically choose these
distributions as it is done in the following example. Notice therein,
that the user has to provide the limits of the beta distribution,
because the default domain, the interval
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(0, 1)</annotation></semantics></math>,
does not cover the range of the sample’s survival times. Moreover, in
this example, the plots are drawn with the <strong>ggplot2</strong>
package (<code>ggp = TRUE</code>) and the parameter estimates will not
be returned on the screen (<code>prnt = FALSE</code>). We can see that
neither the exponential nor the beta distribution fit well to the data.
The corresponding code is the following.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cumhazPlot.html">cumhazPlot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exponential"</span>, <span class="st">"beta"</span>, <span class="st">"lognormal"</span><span class="op">)</span>, </span>
<span>           betaLimits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">100</span><span class="op">)</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span>, prnt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="kaplan-meier-comparison">Kaplan-Meier comparison<a class="anchor" aria-label="anchor" href="#kaplan-meier-comparison"></a>
</h3>
<p>The <strong>GofCens</strong> package includes a function to
graphically compare the Kaplan-Meier estimate of the survival function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mi>n</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\hat{F}_n(t))</annotation></semantics></math>
with the parametric estimations of the survival function from the
parametric models under study
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mover><mi>F</mi><mo accent="true">̂</mo></mover><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">(1-\hat{F}_0(t))</annotation></semantics></math>.
This function is the <code>kmplot()</code>.</p>
<p>For this purpose, each parametric estimation is individually added to
the Kaplan-Meier estimator of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">S(t)</annotation></semantics></math>.
Likewise the <code><a href="../reference/cumhazPlot.html">cumhazPlot()</a></code> function, this is done by default
for the Weibull, Gumbel, log-logistic, logistic, log-normal, and normal
distributions. Additionally, users have the option to choose the
exponential and beta distributions. By default, the plots are generated
using the <strong>graphics</strong> package, but setting the argument
<code>ggp = TRUE</code> allows for the use of the
<strong>ggplot2</strong> package. With both options, the pointwise
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>95</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">95\%</annotation></semantics></math>
confidence intervals are plotted.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/kmPlot.html">kmPlot</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span>, prnt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>As expected, the log-normal distribution exhibits the best fit to the
data. Nevertheless, based on the plots in this figure one might also
consider the log-logistic distribution as a parametric model that fits
well to the sample data.</p>
</div>
<div class="section level3">
<h3 id="real-data-example-survival-times-of-retired-nba-players">Real data example: Survival times of retired NBA players<a class="anchor" aria-label="anchor" href="#real-data-example-survival-times-of-retired-nba-players"></a>
</h3>
<p>In this section, we apply the above functions of the
<strong>GofCens</strong> package to determine which parametric model
fits best to the survival times of former NBA players.</p>
<p>The data frame <em>nba</em> comes with the <strong>GofCens</strong>
package and contains the survival times (variable <code>survtime</code>)
of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3962</mn><annotation encoding="application/x-tex">3962</annotation></semantics></math>
former players of the of the National Basketball Association (NBA) until
July 2019. Survival times are measured as the elapsed time (in years)
from the end of the NBA career until either death
(<code>cens == 1</code>) or July 31, 2019 (<code>cens == 1</code>). By
this date,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>864</mn><annotation encoding="application/x-tex">864</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>21.8</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">21.8\%</annotation></semantics></math>)
of the former players had died with uncensored post-NBA survival times
ranging from a few days until nearly 70 years.</p>
<p>In order to estimate the median and model the survival times
parametrically, we need to know which distribution is the most
appropriate distribution. For this purpose, we take advantage of the
<code><a href="../reference/cumhazPlot.html">cumhazPlot()</a></code> function, which provides the following six
cumulative hazard plots:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nba"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cumhazPlot.html">cumhazPlot</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">survtime</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">nba</span>, font.lab <span class="op">=</span> <span class="fl">4</span>, cex.lab <span class="op">=</span> <span class="fl">1.3</span>, </span>
<span>           prnt <span class="op">=</span> <span class="cn">FALSE</span>, lwd <span class="op">=</span> <span class="fl">3</span>, colour <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>According to the cumulative hazard plots above, the logistic
distribution fits reasonably well to the data, even though the
corresponding plot does not show a completely straight line of the
points. In addition, we could also consider the normal distribution for
parametric analyses of the survival times. To choose one of either
distributions, we run the following code to draw probability and
quantile-quantile plots with the <code><a href="../reference/probPlot.html">probPlot()</a></code> function. In
addition, we estimate the parameter of the logistic distribution fitted
to the data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/probPlot.html">probPlot</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">survtime</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">nba</span>, distr <span class="op">=</span> <span class="st">"logistic"</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>         degs <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: logistic </span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; Location (se): 53.08 (0.46)</span></span>
<span><span class="co">#&gt;    Scale (se): 9.01 (0.22)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    AIC: 8460.3 </span></span>
<span><span class="co">#&gt;    BIC: 8472.87</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/probPlot.html">probPlot</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">survtime</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">nba</span>, distr <span class="op">=</span> <span class="st">"normal"</span>, ggp <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>         prnt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Graphical_Tools_files/figure-html/unnamed-chunk-10-2.png" width="700"></p>
<p>According to the plots exposed above, the logistic distribution
appears to be a slightly better choice than the normal distribution, as
the points in all four plots for the normal distribution show some
curvature.</p>
<p>Note that in the previous function calls, we used the
<code><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula()</a></code> versions of both functions, which allow for the
inclusion of the data frame nba in the argument list, which simplifies
their use.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Klaus Langohr, Mireia Besalú, Matilde Francisco, Arnau Garcia, Guadalupe Gómez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>

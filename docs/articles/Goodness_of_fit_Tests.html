<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Goodness of fit Tests • GofCens</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Goodness of fit Tests">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">GofCens</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Goodness_of_fit_Tests.html">Goodness of fit Tests</a>
    </li>
    <li>
      <a href="../articles/Graphical_Tools.html">Graphical Tools</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ArnauGarciaGRBIO/GofCens/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Goodness of fit Tests</h1>
                        <h4 data-toc-skip class="author">Arnau
Garcia</h4>
            
            <h4 data-toc-skip class="date">2025-05-22</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ArnauGarciaGRBIO/GofCens/blob/HEAD/vignettes/Goodness_of_fit_Tests.Rmd" class="external-link"><code>vignettes/Goodness_of_fit_Tests.Rmd</code></a></small>
      <div class="hidden name"><code>Goodness_of_fit_Tests.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="goodness-of-fit-tests-for-complete-and-right-censored-data">Goodness of fit tests for complete and right-censored data<a class="anchor" aria-label="anchor" href="#goodness-of-fit-tests-for-complete-and-right-censored-data"></a>
</h2>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
denote the time until the occurrence of an event of interest, whose
distribution function we denote by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math>.
The <strong>GofCens</strong> package offers various goodness-of-fit
techniques to assess whether a univariate sample from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>,
either complete or right-censored, i.e., the observed times are smaller
than the actual times of interest, comes from a specified (continuous)
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F_0(t;\theta)</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
represents a vector of unknown parameters. Formally, the null hypothesis
goodness-of-fit test is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>F</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">H_0: F(t)=F_0(t;\theta)</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
representing a vector of unknown parameters. Specifically, the
<strong>GofCens</strong> package provides implementations of well-known
tests such as the Kolmogorov-Smirnov, Cramér-von Mises, and
Anderson-Darling tests based on the empirical distribution function for
complete data and their extensions for right-censored data.
Additionally, <strong>GofCens</strong> includes a chi-squared-type test
based on the squared differences between observed and expected counts
using random cells, with an extension tailored for right-censored
data.</p>
<p>We will illustrate how the functions of the package works using the
following simulated survival times. We generate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>300</mn><annotation encoding="application/x-tex">300</annotation></semantics></math>
survival times from a log-normal distribution with location parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mu = 2</annotation></semantics></math>
and scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\beta=1</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi><mo>∼</mo><mi>L</mi><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">T\sim LN(2,1)</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>300</mn><annotation encoding="application/x-tex">300</annotation></semantics></math>
censoring times from an exponential distribution with scale parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>20</mn></mrow><annotation encoding="application/x-tex">\beta=20</annotation></semantics></math>,
i.e. <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mo>∼</mo><mi>E</mi><mi>x</mi><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>20</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">C\sim Exp(20)</annotation></semantics></math>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">survt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Lognormal.html" class="external-link">rlnorm</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">censt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1</span> <span class="op">/</span> <span class="fl">20</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p>The observed right-censored survival times,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>,</mo><mi>C</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y = min(T, C)</annotation></semantics></math>,
and the corresponding event indicators,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>𝟏</mn><mo stretchy="false" form="prefix">{</mo><mi>T</mi><mo>≤</mo><mi>C</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\delta = \boldsymbol{1}\{T \leq C\}</annotation></semantics></math>,
are created as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">times</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">survt</span>, <span class="va">censt</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">survt</span> <span class="op">&lt;=</span> <span class="va">censt</span><span class="op">)</span></span></code></pre></div>
<p>In total,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>106</mn><annotation encoding="application/x-tex">106</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>35.3</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">35.3\%</annotation></semantics></math>)
of the survival times of the generated sample are right-censored:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">delta</span><span class="op">)</span></span>
<span><span class="co">#&gt; delta</span></span>
<span><span class="co">#&gt;   0   1 </span></span>
<span><span class="co">#&gt; 106 194</span></span></code></pre></div>
<div class="section level3">
<h3 id="kolmogorov-smirnov-test">Kolmogorov-Smirnov test<a class="anchor" aria-label="anchor" href="#kolmogorov-smirnov-test"></a>
</h3>
<p>The Kolmogorov-Smirnov test adapted to right-censored data is
implemented in the function <code><a href="../reference/KScens.html">KScens()</a></code> of the
<strong>GofCens</strong> package. This function provides the observed
Kolmogorov-Smirnov statistic adapted to right-censored data and the
p-value that can be computed either via the theoretical approximation or
via bootstrap methods.</p>
<p>We run the <code><a href="../reference/KScens.html">KScens()</a></code> function to assess the goodness of
fit of the log-normal and the Weibull distributions. The p-value
obtained with the log-normal distribution is, as expected, quite large,
whereas the low p-value in the second example provides large evidence
against the Weibull distribution.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/KScens.html">KScens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a lognormal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; KS Test results:</span></span>
<span><span class="co">#&gt;       A p-value </span></span>
<span><span class="co">#&gt;   0.781   0.116</span></span></code></pre></div>
<p>Note that in this second example, with apply the internal function
<code><a href="../reference/methods_tests.html">print.KScens()</a></code>, which allows us to change the default list
output to a table format (<code>outp = "table"</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/KScens.html">KScens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span>, outp <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: weibull </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; KS Test results:</span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; Metric  | Value  </span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; A       | 1.391  </span></span>
<span><span class="co">#&gt; p-value | 0.001  </span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; Parameter | Value     | s.e.     </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; shape     | 1.273     | 0.067    </span></span>
<span><span class="co">#&gt; scale     | 10.98     | 0.621    </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AIC: 1304.046 </span></span>
<span><span class="co">#&gt; BIC: 1311.453</span></span></code></pre></div>
<p>By default the <code><a href="../reference/KScens.html">KScens()</a></code> function computes the p-value
via bootstrap methods, nonetheless if the argument
<code>boot=FALSE</code> is used, the computation of the p-value is done
using the theoretical approximation. Let us see an example:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/KScens.html">KScens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span>, boot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a lognormal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; KS Test results:</span></span>
<span><span class="co">#&gt;       A p-value </span></span>
<span><span class="co">#&gt;   0.781   0.576</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cramér-von-mises-test">Cramér-von Mises test<a class="anchor" aria-label="anchor" href="#cram%C3%A9r-von-mises-test"></a>
</h3>
<p>The function <code><a href="../reference/CvMcens.html">CvMcens()</a></code> of the <strong>GofCens</strong>
package provides both the observed Cramér-von Mises statistic adapted to
right-censored data and the p-value obtained via bootstrap methods.</p>
<p>We run the <code><a href="../reference/CvMcens.html">CvMcens()</a></code> function to assess the goodness of
fit of the log-normal and the Weibull distributions, as before. Hence,
the null hypotheses in the illustrations remain the same as before, as
do the conclusions: we would conclude that the data may come from a
log-normal distribution, but not from a Weibull distribution.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CvMcens.html">CvMcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a lognormal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CvM Test results:</span></span>
<span><span class="co">#&gt;     CvM p-value </span></span>
<span><span class="co">#&gt;   0.054   0.450</span></span></code></pre></div>
<p>And for the Weibull distribution:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/CvMcens.html">CvMcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a weibull distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; CvM Test results:</span></span>
<span><span class="co">#&gt;     CvM p-value </span></span>
<span><span class="co">#&gt;   0.376   0.001</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="anderson-darling">Anderson-Darling<a class="anchor" aria-label="anchor" href="#anderson-darling"></a>
</h3>
<p>The function <code><a href="../reference/ADcens.html">ADcens()</a></code> of the <strong>GofCens</strong>
package provides both the observed Anderson-Darling statistic adapted to
right-censored data and the p-value obtained via bootstrap methods.</p>
<p>For example, we can test the null hypothesis that the data come from
a log-normal distribution with location and scale parameters equal to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">\mu=2</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mo>=</mo><mn>1.5</mn></mrow><annotation encoding="application/x-tex">\beta=1.5</annotation></semantics></math>,
respectively. In this case, as shown below, the Anderson-Darling test
clearly rejects the null hypothesis. Note that the output now displays
both the parameters of the null hypothesis and the estimated
parameters</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/ADcens.html">ADcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span>, </span>
<span>             params0 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>location <span class="op">=</span> <span class="fl">2</span>, scale <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span>, outp <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: lognormal </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Null hypothesis:</span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; Parameter | Value    </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; location  | 2        </span></span>
<span><span class="co">#&gt; scale     | 1.5      </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AD Test results:</span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; Metric  | Value  </span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; AD      | 9.536  </span></span>
<span><span class="co">#&gt; p-value | 0.001  </span></span>
<span><span class="co">#&gt; ------- | -------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; Parameter | Value     | s.e.     </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; location  | 1.988     | 0.058    </span></span>
<span><span class="co">#&gt; scale     | 0.883     | 0.045    </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AIC: 1266.899 </span></span>
<span><span class="co">#&gt; BIC: 1274.307</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="gofcens-function">Gofcens function<a class="anchor" aria-label="anchor" href="#gofcens-function"></a>
</h3>
<p>There is a function implemented computing the three p-values for the
three previous tests simultaneously by means of bootstrapping methods.
The function <code><a href="../reference/gofcens.html">gofcens()</a></code> computes the test statistics of the
Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling tests adapted
to right-censored data and returns the corresponding p values computed
via bootstrap methods.</p>
<p>Let us expose a couple of examples with the <code><a href="../reference/gofcens.html">gofcens()</a></code>
function:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gofcens.html">gofcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a lognormal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test statistics</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 0.781 0.054 0.500 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 0.115 0.450 0.520</span></span></code></pre></div>
<p>Now we use the function to assess whether the Weibull distribution
fits the data, and we print the results in the table format.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/gofcens.html">gofcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span>, outp <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: weibull </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Tests results:</span></span>
<span><span class="co">#&gt; ---------------- | ---------------- | ----------------</span></span>
<span><span class="co">#&gt; Test             | Statistics value | p-value         </span></span>
<span><span class="co">#&gt; ---------------- | ---------------- | ----------------</span></span>
<span><span class="co">#&gt; KS               | 1.391            | 0.001           </span></span>
<span><span class="co">#&gt; CvM              | 0.376            | 0.001           </span></span>
<span><span class="co">#&gt; AD               | 2.828            | 0.001           </span></span>
<span><span class="co">#&gt; ---------------- | ---------------- | ----------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; Parameter | Value     | s.e.     </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; shape     | 1.273     | 0.067    </span></span>
<span><span class="co">#&gt; scale     | 10.98     | 0.621    </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AIC: 1304.046 </span></span>
<span><span class="co">#&gt; BIC: 1311.453</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="chi-squared-type-test">Chi-squared type test<a class="anchor" aria-label="anchor" href="#chi-squared-type-test"></a>
</h3>
<p>Chi-squared type tests are also implemented, the function
<code><a href="../reference/chisqcens.html">chisqcens()</a></code> of the <strong>GofCens</strong> package uses
bootstrap techniques to compute the p-value.</p>
<p>In this function two random cell numbers are provided: the number
chosen by the user (Original) and the final number (Final), which might
be smaller than the previous one because of right-censored data. For
example, in the following illustrations with the data of the
right-censored sample from the log-normal distribution, we choose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>8</mn></mrow><annotation encoding="application/x-tex">M = 8</annotation></semantics></math>
random cells, but as shown in the output, the number is reduced to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi><mo>=</mo><mn>7</mn></mrow><annotation encoding="application/x-tex">M = 7</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/chisqcens.html">chisqcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, M <span class="op">=</span> <span class="fl">8</span>, distr <span class="op">=</span> <span class="st">"lognormal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a lognormal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-squared Test results:</span></span>
<span><span class="co">#&gt; Statistic   p-value </span></span>
<span><span class="co">#&gt;     3.123     0.154</span></span></code></pre></div>
<p>Now we use the function for the Weibull distribution and we print it
in the table format.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="../reference/chisqcens.html">chisqcens</a></span><span class="op">(</span><span class="va">times</span>, <span class="va">delta</span>, M <span class="op">=</span> <span class="fl">8</span>, distr <span class="op">=</span> <span class="st">"weibull"</span><span class="op">)</span>, outp <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Distribution: weibull </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Chi-squared Test results:</span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; Metric    | Value    </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; Statistic | 8.599    </span></span>
<span><span class="co">#&gt; p-value   | 0.002    </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Parameter estimates:</span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; Parameter | Value     | s.e.     </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; shape     | 1.273     | 0.067    </span></span>
<span><span class="co">#&gt; scale     | 10.98     | 0.621    </span></span>
<span><span class="co">#&gt; --------- | --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cell numbers:</span></span>
<span><span class="co">#&gt; Original  | Final    </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; 8         | 7        </span></span>
<span><span class="co">#&gt; --------- | ---------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AIC: 1304.046 </span></span>
<span><span class="co">#&gt; BIC: 1311.453</span></span></code></pre></div>
<p>Again, based on the outputs, we would choose the log-normal
distribution instead of the Weibull distribution, because its value of
the test statistic is clearly smaller and the p-value is far larger.</p>
</div>
<div class="section level3">
<h3 id="real-data-example-survival-times-of-retired-nba-players">Real data example: Survival times of retired NBA players<a class="anchor" aria-label="anchor" href="#real-data-example-survival-times-of-retired-nba-players"></a>
</h3>
<p>In this section, we apply the above functions of the
<strong>GofCens</strong> package to determine which parametric model
fits best to the survival times of former NBA players.</p>
<p>The data frame <em>nba</em> comes with the <strong>GofCens</strong>
package and contains the survival times (variable <code>survtime</code>)
of all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>3962</mn><annotation encoding="application/x-tex">3962</annotation></semantics></math>
former players of the of the National Basketball Association (NBA) until
July 2019. Survival times are measured as the elapsed time (in years)
from the end of the NBA career until either death
(<code>cens == 1</code>) or July 31, 2019 (<code>cens == 1</code>). By
this date,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>864</mn><annotation encoding="application/x-tex">864</annotation></semantics></math>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>21.8</mn><mi>%</mi></mrow><annotation encoding="application/x-tex">21.8\%</annotation></semantics></math>)
of the former players had died with uncensored post-NBA survival times
ranging from a few days until nearly 70 years.</p>
<p>We apply the <code><a href="../reference/gofcens.html">gofcens()</a></code> function to the logistic and
normal distributions in order to see the results of the
Kolmogorov-Smirnov, Cramér-von Mises, and Anderson-Darling tests. To
reduce the computation times, which would otherwise be very long, we
first select a random sample of survival times of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>500</mn></mrow><annotation encoding="application/x-tex">n=500</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"nba"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">nbasamp</span> <span class="op">&lt;-</span> <span class="va">nba</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">nba</span><span class="op">)</span>, <span class="fl">500</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gofcens.html">gofcens</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">survtime</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">nbasamp</span>, distr <span class="op">=</span> <span class="st">"logistic"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a logistic distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test statistics</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 0.911 0.229 2.450 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 0.017 0.123 0.056</span></span></code></pre></div>
<p>Now for the normal distribution:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gofcens.html">gofcens</a></span><span class="op">(</span><span class="fu">Surv</span><span class="op">(</span><span class="va">survtime</span>, <span class="va">cens</span><span class="op">)</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">nbasamp</span>, distr <span class="op">=</span> <span class="st">"normal"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Null hypothesis: the data follows a normal distribution </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test statistics</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 1.207 0.432 3.787 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; p-values</span></span>
<span><span class="co">#&gt;    KS   CvM    AD </span></span>
<span><span class="co">#&gt; 0.001 0.046 0.027</span></span></code></pre></div>
<p>The test statistics of all three tests are smaller in the case of the
logistic distribution and the corresponding p-values are larger. Thus,
we would select the logistic distribution over the normal
distribution.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Klaus Langohr, Mireia Besalú, Matilde Francisco, Arnau Garcia, Guadalupe Gómez.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
